<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>defer - Csound Plugins</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/syntax-highlighting.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "defer";
    var mkdocs_page_input_path = "opcodes/defer.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> Csound Plugins</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../index.html">Csound Plugins</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Contributing.html">Contributing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Installation.html">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Opcodes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="accum.html">accum</a>
                </li>
                <li class="">
                    
    <a class="" href="atstop.html">atstop</a>
                </li>
                <li class="">
                    
    <a class="" href="cacheget.html">cacheget</a>
                </li>
                <li class="">
                    
    <a class="" href="cachepop.html">cachepop</a>
                </li>
                <li class="">
                    
    <a class="" href="cacheput.html">cacheput</a>
                </li>
                <li class="">
                    
    <a class="" href="crackle.html">crackle</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="defer.html">defer</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#defer">defer</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#abstract">Abstract</a></li>
        
            <li><a class="toctree-l4" href="#description">Description</a></li>
        
            <li><a class="toctree-l4" href="#syntax">Syntax</a></li>
        
            <li><a class="toctree-l4" href="#arguments">Arguments</a></li>
        
            <li><a class="toctree-l4" href="#execution-time">Execution Time</a></li>
        
            <li><a class="toctree-l4" href="#examples">Examples</a></li>
        
            <li><a class="toctree-l4" href="#see-also">See also</a></li>
        
            <li><a class="toctree-l4" href="#credits">Credits</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="dict_exists.html">dict_exists</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_free.html">dict_free</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_get.html">dict_get</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_iter.html">dict_iter</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_new.html">dict_new</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_print.html">dict_print</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_query.html">dict_query</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_set.html">dict_set</a>
                </li>
                <li class="">
                    
    <a class="" href="dict_size.html">dict_size</a>
                </li>
                <li class="">
                    
    <a class="" href="diode_ringmod.html">diode_ringmod</a>
                </li>
                <li class="">
                    
    <a class="" href="file_exists.html">file_exists</a>
                </li>
                <li class="">
                    
    <a class="" href="frac2int.html">frac2int</a>
                </li>
                <li class="">
                    
    <a class="" href="jsfx.html">jsfx</a>
                </li>
                <li class="">
                    
    <a class="" href="jsfx_getslider.html">jsfx_setslider</a>
                </li>
                <li class="">
                    
    <a class="" href="jsfx_new.html">jsfx_new</a>
                </li>
                <li class="">
                    
    <a class="" href="jsfx_play.html">jsfx_play</a>
                </li>
                <li class="">
                    
    <a class="" href="jsfx_setslider.html">jsfx_setslider</a>
                </li>
                <li class="">
                    
    <a class="" href="lfnoise.html">lfnoise</a>
                </li>
                <li class="">
                    
    <a class="" href="linenv.html">linenv</a>
                </li>
                <li class="">
                    
    <a class="" href="poly.html">poly</a>
                </li>
                <li class="">
                    
    <a class="" href="poly0.html">poly0</a>
                </li>
                <li class="">
                    
    <a class="" href="polyseq.html">polyseq</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_at.html">pool_at</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_capacity.html">pool_capacity</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_gen.html">pool_gen</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_new.html">pool_new</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_pop.html">pool_push</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_push.html">pool_push</a>
                </li>
                <li class="">
                    
    <a class="" href="pool_size.html">pool_size</a>
                </li>
                <li class="">
                    
    <a class="" href="pread.html">pread</a>
                </li>
                <li class="">
                    
    <a class="" href="pwrite.html">pwrite</a>
                </li>
                <li class="">
                    
    <a class="" href="ramptrig.html">ramptrig</a>
                </li>
                <li class="">
                    
    <a class="" href="schmitt.html">schmitt</a>
                </li>
                <li class="">
                    
    <a class="" href="sigmdrive.html">sigmdrive</a>
                </li>
                <li class="">
                    
    <a class="" href="standardchaos.html">standardchaos</a>
                </li>
                <li class="">
                    
    <a class="" href="tubeharmonics.html">tubeharmonics</a>
                </li>
                <li class="">
                    
    <a class="" href="uniqinstance.html">uniqinstance</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Csound Plugins</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>Opcodes &raquo;</li>
        
      
    
    <li>defer</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="defer">defer</h1>
<h2 id="abstract">Abstract</h2>
<p>Run an opcode at the end of current event</p>
<h2 id="description">Description</h2>
<p><code>defer</code> runs an opcode as the last action of a given event, during the process
of being deallocated. This can be used together with opcodes which release
resources back which are being used during the event. At the moment <code>defer</code>
works only with builtin opcodes. For complex release actions, it is nonetheless
possible to bundle the actions in a separate instrument and use <code>schedule</code>
together with defer (or simpler, use <code>atstop</code> instead).</p>
<div class="admonition note">
<p class="admonition-title">Release time vs deinit time</p>
<p>The event is not scheduled at <em>release</em> time (see below "Release time vs Deinit time")
but at the moment the note is freed.</p>
<p><strong>Release time</strong> is when the note is within its <em>release phase</em>, which will only happen
if the note has an envelope with a release segment (like <code>linsegr</code>), or if it has
setup extra time with <code>xtratim</code>. The opcode <code>release</code> can be used to query if the
current note is being released. The instrument keeps running in release phase as
long as the release part of the envelope is finished or the extra time allocated
via <code>xtratim</code> is through.</p>
<p><strong>Deinit time</strong> is the moment the note is actually being freed, so the instrument is
not running anymore at this point.</p>
</div>
<h2 id="syntax">Syntax</h2>
<div class="codehilite"><pre><span></span>defer Sopcode, [arg1, arg2, ...]
</pre></div>


<p>Any arguments passed after the name of the opcode (which must be within
quotations) are passed directly to the opcode itself. Notice that only opcodes
without output make sense in this context. Useful opcodes are <code>print</code>, <code>prints</code>,
<a href="pool_push.html">pool_push</a>, <a href="dict_free.html">dict_free</a>, etc</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>defer</code> evaluates at init time but acts at deacllocation time. The arguments
passed are evaluated at deallocation time</p>
</div>
<h2 id="arguments">Arguments</h2>
<ul>
<li><code>Sopcode</code>: the name of the opcode to defer</li>
<li><code>args</code>: any args (i, k, S) are passed to the opcodes. They are evaluated at
  deallocation time.</li>
</ul>
<h2 id="execution-time">Execution Time</h2>
<ul>
<li>Init</li>
<li>Deallocation</li>
</ul>
<h2 id="examples">Examples</h2>
<div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="n">CsoundSynthesizer</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">CsOptions</span><span class="o">&gt;</span>
<span class="o">-</span><span class="n">odac</span>           

<span class="o">&lt;/</span><span class="n">CsOptions</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">CsInstruments</span><span class="o">&gt;</span>
<span class="vg">sr</span>     <span class="o">=</span> <span class="mi">44100</span>
<span class="vg">ksmps</span>  <span class="o">=</span> <span class="mi">64</span>
<span class="vg">nchnls</span> <span class="o">=</span> <span class="mi">2</span>
<span class="vg">0dbfs</span>  <span class="o">=</span> <span class="mi">1</span>

<span class="c1">;; Example 1</span>
<span class="kd">instr</span> <span class="nf">1</span>
  <span class="nb">printk2</span> <span class="nb">timeinsts</span><span class="p">()</span>
  <span class="c1">;; this will be called at the end of this instrument</span>
  <span class="n">defer</span> <span class="s">&quot;event_i&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">93</span>
<span class="kd">endin</span>

<span class="kd">instr</span> <span class="nf">2</span>
  <span class="nb">print</span> <span class="vi">p4</span>
  <span class="nb">turnoff</span>
<span class="kd">endin</span>

<span class="kd">instr</span> <span class="nf">example1</span>
  <span class="nb">schedule</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span>
  <span class="nb">turnoff</span>
<span class="kd">endin</span>

<span class="c1">;; -------------------------------------------</span>
<span class="c1">;; Example 2</span>

<span class="kd">instr</span> <span class="nf">10</span>
  <span class="kt">i</span><span class="n">dict</span> <span class="n">dict_new</span> <span class="s">&quot;*sf&quot;</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="mi">200</span>
  <span class="c1">;; delete this key at the end of the note</span>
  <span class="n">defer</span> <span class="s">&quot;dict_set&quot;</span><span class="p">,</span> <span class="kt">i</span><span class="n">dict</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span>
  <span class="n">dict_print</span> <span class="kt">i</span><span class="n">dict</span>
  <span class="nb">schedule</span> <span class="mi">11</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">i</span><span class="n">dict</span>
  <span class="nb">turnoff</span>
<span class="kd">endin</span> 

<span class="kd">instr</span> <span class="nf">11</span>
<span class="nb">printf</span> <span class="s">&quot;Instr 11 </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="mi">1</span>
  <span class="kt">i</span><span class="n">dict</span> <span class="o">=</span> <span class="vi">p4</span>
  <span class="c1">;; by now the dict should have deleted the key &quot;foo&quot;</span>
  <span class="n">dict_print</span> <span class="kt">i</span><span class="n">dict</span>
  <span class="nb">turnoff</span>
<span class="kd">endin</span>

<span class="kd">instr</span> <span class="nf">example2</span>
  <span class="nb">schedule</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="kd">endin</span>

<span class="nb">schedule</span> <span class="s">&quot;example2&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="o">&lt;/</span><span class="n">CsInstruments</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">CsScore</span><span class="o">&gt;</span>
<span class="n">e</span> <span class="mi">3</span>
<span class="c1">; f0 3600</span>

<span class="o">&lt;/</span><span class="n">CsScore</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">CsoundSynthesizer</span><span class="o">&gt;</span>
</pre></div>


<h2 id="see-also">See also</h2>
<ul>
<li><a href="atstop.html">atstop</a></li>
<li><a href="http://www.csounds.com/manual/html/schedule.html">schedule</a></li>
<li><a href="http://www.csounds.com/manual/html/event.html">event</a></li>
<li><a href="http://www.csounds.com/manual/html/release.html">release</a></li>
<li><a href="http://www.csounds.com/manual/html/xtratim.html">xtratim</a></li>
</ul>
<h2 id="credits">Credits</h2>
<p>Eduardo Moguillansky, 2019</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dict_exists.html" class="btn btn-neutral float-right" title="dict_exists">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="crackle.html" class="btn btn-neutral" title="crackle"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="crackle.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="dict_exists.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
